(this["webpackJsonpmy-create-react-app"]=this["webpackJsonpmy-create-react-app"]||[]).push([[1],{324:function(e,t,n){e.exports=n(490)},329:function(e,t,n){},330:function(e,t,n){},490:function(e,t,n){"use strict";n.r(t);var a=n(23),o=n.n(a),i=n(148),r=n.n(i),s=(n(329),n(159)),c=n(160),l=n(169),u=n(161),m=n(189),p=n(170),h=(n(330),n(200)),d=function(e){return o.a.createElement("div",{id:"editor-container",style:{}})},f=function(e){return 0===e.errors.length?o.a.createElement("div",{style:{background:"#bcfbb8",width:"700px",paddingLeft:"10px"}},"The above settings object is VALID"):o.a.createElement("div",{style:{background:"#fbb8b8",width:"700px",paddingLeft:"10px"}},"The above settings object contains the following errors:",e.errors.map((function(e){return o.a.createElement("li",null,e)})))},_=function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(o)))).state={errors:[]},n.prevHeight=0,n.updateEditorHeight=function(){var e,t=n.editor.getDomNode();if(t){var a=n.editor.getOption(h.editor.EditorOption.lineHeight),o=(null===(e=n.editor.getModel())||void 0===e?void 0:e.getLineCount())||1,i=n.editor.getTopForLineNumber(o+1)+a;n.prevHeight!==i&&(n.prevHeight=i,t.style.height="".concat(i,"px"),n.editor.layout())}},n}return Object(p.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this,t="https://raw.githubusercontent.com/moj-analytical-services/splink/master/splink/files/settings_jsonschema.json";fetch(t).then((function(e){return e.json()})).then((function(n){var a=n,o=e.props.editor_contents_string;e.monaco=h;var i=e.monaco.Uri.parse("a://b/foo.json"),r=e.monaco.editor.createModel(o,"json",i);e.monaco.languages.json.jsonDefaults.setDiagnosticsOptions({validate:!0,schemas:[{uri:t,fileMatch:[i.toString()],schema:a}]}),e.editor=e.monaco.editor.create(document.getElementById("editor-container"),{value:o,automaticLayout:!1,language:"json",model:r,wordWrap:"on",scrollbar:{vertical:"hidden",handleMouseWheel:!1},scrollBeyondLastLine:!1,minimap:{enabled:!1},theme:"vs-dark",insertSpaces:!0}),e.model=r,e.editor.onDidChangeModelDecorations((function(){var t=e.editor.getModel();e.updateEditorHeight();var n=t.getModeId(),a=h.editor.getModelMarkers({owner:n}),o=[];a.forEach((function(e){var t=e.message,n=e.startLineNumber;t="Error: ".concat(t," at line ").concat(n),o.push(t)})),e.setState({errors:o})}))}))}},{key:"componentDidUpdate",value:function(e){e.option_selection!==this.props.option_selection&&this.editor.setValue(this.props.editor_contents_string)}},{key:"render",value:function(){return o.a.createElement("div",null,o.a.createElement("ul",null,o.a.createElement("li",null," Hover over fields to get a description of their purpose "),o.a.createElement("li",null," ctrl+space to autocomplete fields "),o.a.createElement("li",null," ctrl+shift+f to format the document ")),o.a.createElement(d,{className:"monaco-window"}),o.a.createElement(f,{errors:this.state.errors}))}}]),t}(o.a.Component);var v=function(e){return o.a.createElement("div",null,o.a.createElement("h1",null,"Splink settings editor with autocomplete and validation"),o.a.createElement("p",null,"Use the code editor below to author a ",o.a.createElement("code",null,"splink")," settings dictionary."))},g=n(322),b=n(317),j=n.n(b),y=function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(o)))).state={schema:null,selected_option:null},n.handleChange=function(e){var t=n.state.schema;n.setState({schema:t,selected_option:e})},n}return Object(p.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;fetch("https://raw.githubusercontent.com/moj-analytical-services/splink/master/splink/files/settings_jsonschema.json").then((function(e){return e.json()})).then((function(t){e.schema=t,e.setState({selected_option:null})}))}},{key:"schemaToOptions",value:function(){if(!this.schema)return[];var e=Object.keys(this.schema.properties),t=(e=(e=e.filter((function(e){return"$schema"!==e}))).filter((function(e){return"$id"!==e}))).map((function(e){return{label:e,value:e,is_comparison_col:!1}})),n=(e=(e=(e=Object.keys(this.schema.properties.comparisons.items.properties)).filter((function(e){return"$schema"!==e}))).filter((function(e){return"$id"!==e}))).map((function(e){return{label:e,value:e,is_comparison_col:!0}}));return t.concat(n)}},{key:"optionToSchemaSection",value:function(){if(!this.schema)return{};var e=this.state.selected_option;return e.is_comparison_col?this.schema.properties.comparison_columns.items.properties[e.value]:this.schema.properties[e.value]}},{key:"markdownFromSchemaSection",value:function(e){var t=this.state.selected_option.is_comparison_col,n=this.state.selected_option.value,a=[];if("title"in e&&a.push("**Summary**: ".concat(e.title)),"description"in e&&a.push("**Description**: ".concat(e.description)),"default"in e&&a.push("**Default value if not provided**: ".concat(e.default)),"type"in e&&a.push("**Data type**: ".concat(e.type)),"enum"in e){var o=e.enum.join(", ");a.push("**Takes one of the following values**: ".concat(o))}if("examples"in e){var i="";"string"===e.type&&(i='"');var r=[];t?(r.push("settings = {"),r.push('    "comparison_columns": ['),r.push("        {"),r.push('    "'.concat(n,'": ').concat(i).concat(e.examples[0]).concat(i)),r.push("        }"),r.push("    ]"),r.push("}"),r=r.join("\n")):(r.push("settings = {"),r.push('    "'.concat(n,'": ').concat(i).concat(e.examples[0]).concat(i)),r.push("}"),r=r.join("\n")),a.push("**Example**: \n  ```` \n ".concat(r,"  \n ```` "))}return a.join("\n\n")}},{key:"render",value:function(){var e=this.schemaToOptions(),t="";if(this.state.selected_option){var n=this.optionToSchemaSection();t=this.markdownFromSchemaSection(n)}return o.a.createElement("div",null,o.a.createElement("h2",null,"Setting dictionary key explorer"),o.a.createElement("p",null,"Select a key from the box below for further details about what it does"),o.a.createElement(g.a,{options:e,value:this.state.selected_option,onChange:this.handleChange}),o.a.createElement("br",null),o.a.createElement(j.a,{source:t}))}}]),t}(o.a.Component),E={link_type:"dedupe_only",blocking_rules_to_generate_predictions:["l.first_name = r.first_name","l.surname = r.surname"],comparisons:[{output_column_name:"First name",comparison_levels:[{sql_condition:"first_name_l IS NULL OR first_name_r IS NULL",label_for_charts:"Null",is_null_level:!0},{sql_condition:"first_name_l = first_name_r",label_for_charts:"Exact match",tf_adjustment_column:"first_name",tf_minimum_u_value:.001},{sql_condition:"levenshtein(first_name_l, first_name_r) <= 2",label_for_charts:"Levenstein <= 2",tf_adjustment_column:"first_name",tf_minimum_u_value:.003,tf_adjustment_weight:.5},{sql_condition:"ELSE",label_for_charts:"All other comparisons"}]},{output_column_name:"Surname"},{output_column_name:"Date of birth"}],additional_columns_to_retain:["cluster"]},k=n(319),O=n.n(k),S=n(320),w=n.n(S),x=n(321),L=w.a,D=new O.a(L);D.injectStyles(),Object(x.a)(D);var C=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={option_selection:"id_1"},n.handleChange=function(e){var t=e.value;n.setState({option_selection:t})},n.handleChange=n.handleChange.bind(Object(m.a)(n)),n}return Object(p.a)(t,e),Object(c.a)(t,[{key:"getText",value:function(e){var t=E;return JSON.stringify(t,null,4)}},{key:"render",value:function(){var e=this.getText();return o.a.createElement("div",{className:"App-main-div"},o.a.createElement(v,null),o.a.createElement("div",{className:"App-flex-container"},o.a.createElement("div",{className:"App-flex-item"},o.a.createElement(_,{editor_contents_string:e}))),o.a.createElement(y,null))}}]),t}(o.a.Component);r.a.render(o.a.createElement(C,null),document.getElementById("root"))}},[[324,2,3]]]);
//# sourceMappingURL=main.cbbaf1d0.chunk.js.map